webpackJsonp(["app/js/course-manage/create/index"],{"34bc6a13647d2e759c8b":function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a("64f69b56d0a1d80f135d"),d=function(e){return e&&e.__esModule?e:{default:e}}(i);new(function(){function e(){n(this,e),this.validator=null,this.init(),this.expiry=new d.default}return r(e,[{key:"init",value:function(){$('[data-toggle="popover"]').popover({html:!0}),this.initValidator(),this.expiryDaysBlur()}},{key:"initValidator",value:function(){var e=this,t=$("#course-create-form");this.validator=t.validate({groups:{date:"expiryStartDate expiryEndDate"},rules:{title:{maxlength:10,required:!0,trim:!0}}}),$("#course-submit").click(function(a){e.expiry.commonExpiryMode(),e.validator.form()&&($(a.currentTarget).button("loading"),t.submit())}),this.initDatePicker("#expiryStartDate"),this.initDatePicker("#expiryEndDate"),this.initDatePicker("#deadline")}},{key:"expiryDaysBlur",value:function(){var e=this;$('input[name="expiryDays"]').on("blur",function(t){e.validator.element($(t.target))})}},{key:"initDatePicker",value:function(e){var t=this,a=$(e);a.datetimepicker({format:"yyyy-mm-dd",language:document.documentElement.lang,minView:2,autoclose:!0,endDate:new Date(Date.now()+31536e7)}).on("hide",function(){t.validator&&t.validator.element(a)}),a.datetimepicker("setStartDate",new Date)}}]),e}())},"64f69b56d0a1d80f135d":function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(){n(this,e),this.init()}return r(e,[{key:"init",value:function(){this.checkBoxChange()}},{key:"checkBoxChange",value:function(){var e=this;$('input[name="deadlineType"]').on("change",function(t){var a=$("#deadlineType-date"),n=$("#deadlineType-days"),r=$('input[name="deadlineType"]:checked').val();e.removeErrorTip(t),"end_date"===r?(a.removeClass("hidden"),n.addClass("hidden")):(a.addClass("hidden"),n.removeClass("hidden")),e.commonExpiryMode(!0)}),$('input[name="expiryMode"]').on("change",function(t){var a=$("#expiry-days"),n=$("#expiry-date"),r=$('input[name="expiryMode"]:checked').val();e.removeErrorTip(t);var i=$(".js-expiry-tip");"date"===r?(a.addClass("hidden"),n.removeClass("hidden"),i.removeClass("ml0")):"days"===r?(n.addClass("hidden"),a.removeClass("hidden"),i.removeClass("ml0")):(n.addClass("hidden"),a.addClass("hidden"),i.addClass("ml0")),e.commonExpiryMode(!0)})}},{key:"commonExpiryMode",value:function(e){var t=this,a=$('[name="deadline"]'),n=$('[name="expiryDays"]'),r=$('[name="expiryStartDate"]'),i=$('[name="expiryEndDate"]'),d=$('[name="deadlineType"]:checked'),s=$('[name="expiryMode"]:checked').val();switch(this.elementRemoveRules(a),this.elementRemoveRules(n),this.elementRemoveRules(r),this.elementRemoveRules(i),s){case"days":if("end_date"===d.val())return void(e?a.on("focus",function(){t.elementAddRules(a,t.getDeadlineEndDateRules())}):this.elementAddRules(a,this.getDeadlineEndDateRules()));e?n.on("focus",function(){t.elementAddRules(n,t.getExpiryDaysRules())}):this.elementAddRules(n,this.getExpiryDaysRules());break;case"date":e?(r.on("focus",function(){t.elementAddRules(r,t.getExpiryStartDateRules())}),i.on("focus",function(){t.elementAddRules(i,t.getExpiryEndDateRules())})):(this.elementAddRules(r,this.getExpiryStartDateRules()),this.elementAddRules(i,this.getExpiryEndDateRules()))}}},{key:"removeErrorTip",value:function(e){var t=$(e.target).closest(".form-group");t.removeClass("has-error"),t.find(".js-expiry-input").removeClass("form-control-error"),$(".jq-validate-error").remove()}},{key:"elementRemoveRules",value:function(e){e.rules("remove")}},{key:"elementAddRules",value:function(e,t){e.rules("add",t)}},{key:"getExpiryDaysRules",value:function(){return{required:!0,positive_integer:!0,max_year:!0,messages:{required:Translator.trans(Translator.trans("course.manage.expiry_days_error_hint"))}}}},{key:"getExpiryStartDateRules",value:function(){return{required:!0,date:!0,before_date:"#expiryEndDate",messages:{required:Translator.trans("course.manage.expiry_start_date_error_hint")}}}},{key:"getExpiryEndDateRules",value:function(){return{required:!0,date:!0,after_date:"#expiryStartDate",messages:{required:Translator.trans("course.manage.expiry_end_date_error_hint")}}}},{key:"getDeadlineEndDateRules",value:function(){return{required:!0,date:!0,messages:{required:Translator.trans("course.manage.deadline_end_date_error_hint")}}}}]),e}();t.default=i}},["34bc6a13647d2e759c8b"]);