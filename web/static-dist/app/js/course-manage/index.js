webpackJsonp(["app/js/course-manage/index"],{"46d3fd179253522f9cd7":function(e,t,s){"use strict";var n=s("4e68e437f5b716377a9d"),a=s("f7e82e0c8fee9afe700b"),o=function(e){return e&&e.__esModule?e:{default:e}}(a);(0,n.closeCourse)(),(0,n.deleteCourse)(),(0,n.publishCourse)(),new o.default},"4e68e437f5b716377a9d":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaskListHeaderFixed=t.TabChange=t.showSettings=t.publishCourse=t.deleteCourse=t.closeCourse=void 0;var n=s("48bb97626aecb1ede6bc"),a=(t.closeCourse=function(){$("body").on("click",".js-close-course",function(e){var t=$(e.currentTarget);cd.confirm({title:Translator.trans("site.close"),content:Translator.trans("course.manage.close_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){$.post(t.data("checkUrl"),function(e){if(e.warn)return void cd.confirm({title:Translator.trans("site.close"),content:Translator.trans(e.message),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){a(t)});a(t)})})})},function(e){$.post(e.data("url"),function(e){e.success?(cd.message({type:"success",message:Translator.trans("course.manage.close_success_hint")}),location.reload()):cd.message({type:"danger",message:Translator.trans("course.manage.close_fail_hint")+":"+e.message})})});t.deleteCourse=function(){$("body").on("click",".js-delete-course",function(e){cd.confirm({title:Translator.trans("site.delete"),content:Translator.trans("course.manage.delete_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){$.post($(e.currentTarget).data("url"),function(e){e.success?(cd.message({type:"success",message:Translator.trans("site.delete_success_hint")}),e.redirect?window.location.href=e.redirect:location.reload()):cd.message({type:"danger",message:Translator.trans("site.delete_fail_hint")+":"+e.message})})})})},t.publishCourse=function(){var e={title:"course.manage.publish_title",hint:"course.manage.publish_hint",success:"course.manage.publish_success_hint",fail:"course.manage.publish_fail_hint"};(0,n.publish)(".js-publish-course",e)},t.showSettings=function(){$("#sortable-list").on("click",".js-item-content",function(e){var t=$(e.currentTarget),s=t.closest(".js-task-manage-item");s.hasClass("active")?s.removeClass("active").find(".js-settings-list").stop().slideUp(500):(s.addClass("active").find(".js-settings-list").stop().slideDown(500),s.siblings(".js-task-manage-item.active").removeClass("active").find(".js-settings-list").hide())})},t.TabChange=function(){$('[data-role="tab"]').click(function(e){var t=$(this);$(t.data("tab-content")).removeClass("hidden").siblings('[data-role="tab-content"]').addClass("hidden")})},t.TaskListHeaderFixed=function(){var e=$(".js-task-list-header");if(e.length){var t=e.offset().top;$(window).scroll(function(s){$(window).scrollTop()>=t?e.addClass("fixed"):e.removeClass("fixed")})}}},f7e82e0c8fee9afe700b:function(e,t,s){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),o=s("8f840897d9471c8c1fbd"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),i=function(){function e(){n(this,e),this.$sortBtn=$(".js-sort-btn"),this.createBtn=$(".js-create-plan"),this.sortList=this._getSort(),this.init()}return a(e,[{key:"init",value:function(){this.bindEvent(),this.sortPlanEvent()}},{key:"bindEvent",value:function(){var e=this;this.$sortBtn.on("click",function(){return e.sortEvent()}),$(".js-cancel-sort-btn").on("click",function(){return e.cancelSort()}),$(".js-save-sort-btn").on("click",function(){return e.saveSort()}),cd.select({el:"#select-single",type:"single"}).on("change",function(e,t){e?($(".js-plan-item").not(".js-status-"+e).hide(),$(".js-status-"+e).show()):$(".js-plan-item").show()}),this.copyPlan()}},{key:"copyPlan",value:function(){var e=this,t=$(".js-plan-item").length;$(".js-plan-operation").on("click",".js-copy-plan",function(s){var n=$(s.currentTarget);t>9?cd.confirm({title:Translator.trans("course.manage.copy_title"),content:Translator.trans("course.manage.max_course_number_tip"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){e.createBtn.prop("disabled",!0)}).on("cancle",function(){e.createBtn.prop("disabled",!0)}):$.get(n.data("url"),function(e){$("#modal").modal("show").html(e)})})}},{key:"sortEvent",value:function(){this._toggleSortStatus()}},{key:"sortPlanEvent",value:function(){var e=this,t=$(".js-plan-list"),s=void 0;(0,r.default)({element:t,ajax:!1,group:"nested",placeholder:'<li class="placeholder task-dragged-placeholder cd-mb24"></li>',onDragStart:function(t,n,a){var o=t.offset(),r=n.rootGroup.pointer;s={left:r.left-o.left,top:r.top-o.top},a(t,n),e.hiddenOperations(t)},onDrag:function(e,t){var n=e.height();$(".task-dragged-placeholder").css({height:n,"background-color":"#eee"}),e.css({left:t.left-s.left,top:t.top-s.top})},onDrop:function(t,s,n){n(t,s),e.hiddenOperations(t)}})}},{key:"hiddenOperations",value:function(e){e.find(".js-plan-icon, .js-plan-dragged-icon").toggleClass("hidden")}},{key:"cancelSort",value:function(){this._restore(),this._toggleSortStatus(),cd.message({type:"success",message:Translator.trans("course.manage.sort_cancel")})}},{key:"saveSort",value:function(){var e=this,t=this._getSort();$.post($(".js-plan-list").data("sortUrl"),{ids:t},function(s){cd.message({type:"success",message:Translator.trans("site.save_success_hint")}),e.sortList=t,e._toggleSortStatus()}).error(function(e){cd.message({type:"danger",message:e.responseText})})}},{key:"_restore",value:function(){for(var e=$(".js-plan-list"),t="",s=this.sortList.length,n=0;n<s;n++)t+=e.find("#course-plan-"+this.sortList[n]).prop("outerHTML");e.html(t)}},{key:"_toggleSortStatus",value:function(){$(".js-sort-group, #select-single").toggleClass("hide"),$(".js-plan-item").toggleClass("drag")}},{key:"_getSort",value:function(){var e=[];return $(".js-plan-item").each(function(){e.push($(this).data("courseId"))}),e}}]),e}();t.default=i}},["46d3fd179253522f9cd7"]);