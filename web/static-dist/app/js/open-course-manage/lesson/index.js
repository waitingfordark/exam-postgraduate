webpackJsonp(["app/js/open-course-manage/lesson/index"],{"007f16bb16735f901b3c":function(e,n,s){"use strict";var t=s("33687ed90ec81811e04e");new(function(e){return e&&e.__esModule?e:{default:e}}(t).default)},"33687ed90ec81811e04e":function(e,n,s){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var s=0;s<n.length;s++){var t=n[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,s,t){return s&&e(n.prototype,s),t&&e(n,t),n}}(),o=function(){function e(){t(this,e),this.$item=$(".js-open-course-lesson-item"),this.init()}return a(e,[{key:"init",value:function(){$(".js-file-delete-lesson").tooltip(),this.asyncLoadFiles(),this.bindEvent()}},{key:"bindEvent",value:function(){var e=this;this.$item.on("click",".js-publish-lesson-btn",function(n){return e.publishLesson(n)}),this.$item.on("click",".js-unpublish-lesson-btn",function(n){return e.cancelPublishLesson(n)}),this.$item.on("click",".js-delete-lesson-btn",function(n){return e.deleteLesson(n)}),$(".js-lesson-create-btn").on("click",function(n){return e.createLesson(n)})}},{key:"publishLesson",value:function(e){var n=$(e.target),s=Translator.trans("open_course.publish_lesson_hint");this.togglePublish(n,s)}},{key:"cancelPublishLesson",value:function(e){var n=$(e.target),s=Translator.trans("open_course.unpublish_success_hint");this.togglePublish(n,s)}},{key:"togglePublish",value:function(e,n){$.post(e.data("url"),function(e){$(".js-publish-lesson-btn, .js-delete-lesson-btn, .js-unpublish-lesson-btn").parent().toggleClass("hidden"),$(".js-unpublish-status").toggleClass("hidden"),cd.message({type:"success",message:n})})}},{key:"deleteLesson",value:function(e){var n=this,s=$(e.target);cd.confirm({title:Translator.trans("site.delete"),content:Translator.trans("open_course.lesson_delete_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.close")}).on("ok",function(){$.post(s.data("url"),function(e){n.$item.remove(),$(".js-lesson-notify").show(),$(".js-lesson-create-btn").attr("disabled",!1),cd.message({type:"success",message:Translator.trans("open_course.lesson_delete_success_hint")})},"json")})}},{key:"createLesson",value:function(e){var n=$(e.target).data("url");$.get(n,function(e){e.result?cd.message({type:"warning",message:Translator.trans("open_course.add_lesson_hint")}):($("#modal").html(e),$("#modal").modal("show"))})}},{key:"asyncLoadFiles",value:function(){var e=this,n=$(".js-lesson-manage-panel").data("file-status-url"),s=this.$item.data("fileId");$.post(n,{ids:s},function(n){if(n&&0!=n.length){var s=n[0];"waiting"==s.convertStatus||"doing"==s.convertStatus?e.$item.find('span[data-role="mediaStatus"]').append("<span class='text-warning'>"+Translator.trans("open_course.file_format_conversion_hint")+"</span>"):"error"==s.convertStatus&&e.$item.find('span[data-role="mediaStatus"]').append("<span class='text-danger'>"+Translator.trans("open_course.file_format_conversion_failed_hint")+"</span>")}})}}]),e}();n.default=o}},["007f16bb16735f901b3c"]);